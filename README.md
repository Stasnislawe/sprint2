# **Виртуальная стажировка**

## **Pereval Rest API**

Федерации спортивного туризма России pereval.online (далее - ФСТР) заказала студентам SkillFactory разработать мобильное приложение для Android и IOS, которое упростило бы туристам задачу по отправке данных о перевале и сократило время обработки запроса до трёх дней.

Пользоваться мобильным приложением будут туристы. В горах они будут вносить данные о перевале в приложение и отправлять их в ФСТР, как только появится доступ в Интернет.

Модератор из федерации будет верифицировать и вносить в базу данных информацию, полученную от пользователей, а те в свою очередь смогут увидеть в мобильном приложении статус модерации и просматривать базу с объектами, внесёнными другими.

Турист с помощью мобильного приложения будет передавать в ФСТР следующие данные о перевале:

    Информацию о себе:
        Имя;
        Фамилия;
        Отчество;
        Электронная почта;
        Номер телефона.
    Название объекта;
    Координаты объекта и его высоту;
    Уровень сложности в зависимости от времени года;
    Несколько фотографий.

Метод:

-- GET /mount/ --

Вывод списка данных о перевалах

-- POST /mount/ --

принимает JSON в теле запроса с информацией о перевале. Пример JSON-а:

{
    "beauty_title": "пер.",
    "title": "Пхия",
    "other_titles": "Триев",
    "connect": "",
    "user": {
        "name": "Вася",
        "surname": "Васильев",
        "otc": "Васильевич",
        "email": "vasyavasyliev@mail.ru",
        "phone": "+98634254235"
    },
    "coord": {
        "latitude": "33",
        "longitude": "25",
        "height": "544"
    },
    "level": {
        "winter": "1a",
        "summer": "1b",
        "autumn": "1b",
        "spring": "1b"
    },
    "images": [{"image":"https://img.freepik.com/premium-photo/squirrel-sitting-tree-branch_1048944-30371835.jpg?w=740", "title":"Седловина"}]
}

Результат метода: JSON

    status — код HTTP, целое число:

    500 — ошибка при выполнении операции;

    400 — Bad Request (при нехватке полей);

    200 — успех.

    message — строка:

    Причина ошибки (если она была);

    Отправлено успешно;

    Если отправка успешна, дополнительно возвращается id вставленной записи.

    id — идентификатор, который был присвоен объекту при добавлении в базу данных.

Примеры oтветов:

{ "status": 500, "message": "Ошибка подключения к базе данных","id": null}

{ "status": 200, "message": null, "id": 42 }

После того, как турист добавит в базу данных информацию о новом перевале, сотрудники ФСТР проведут модерацию для каждого нового объекта и поменяют поле status.

Допустимые значения поля status:

    'new';
    'pending' — модератор взял в работу;
    'accepted' — модерация прошла успешно;
    'rejected' — модерация прошла, информация не принята.


-- GET /mount/{id} -- 

Вывод одной записи о перевале по ID


-- PATCH /mount/{id} --

Редактирование записи по ID, работает только в случае когда status == 'new'

state 1 — если успешно удалось отредактировать запись в базе данных.
state 0 — в противном случае.

Примеры ответов:

    "state": "0",
    "message": {
        "non_field_errors": [
            "{'ФИО, email и номер телефона пользователя не могут быть изменены'}"

    "state": "1",
    "message": "Изменения в записи внесены"

    "state": "0",
    "message": "Текущий статус: new, изменить запись нельзя!"


-- DELETE /mount/{id}

Удаление записи по ID 

-- GET /Pereval/?user_id__email=<email>

позволяет получить данные всех объектов, отправленных на сервер пользователем с почтой.
В качестве реализации использована фильтрация по адресу электронной почты пользователя с помощью пакета django-filter


## Проект опубликован на хостинге pythonanywhere.com

Документация swagger: https://stasnislaw.pythonanywhere.com/swagger/
API: https://stasnislaw.pythonanywhere.com/mount/

